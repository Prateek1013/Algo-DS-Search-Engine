
Read problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.
Chef recently took a course in linear algebra and learned about linear combinations of vectors. Therefore, in order to test his intelligence, Raj gave him a "fuzzy" problem to solve.
A sequence of integers B1,B2,…,BMB1,B2,…,BM generates an integer KK if it is possible to find a sequence of integers C1,C2,…,CMC1,C2,…,CM such that C1⋅B1+C2⋅B2+…+CM⋅BM=K.
In this problem, Chef has a sequence A1,A2,…,AN and he should answer Q queries. In each query, he is given an integer K; the answer to this query is the number of pairs (l,r) such that 1≤l≤r≤N and the subsequence (Al,Al+1,…,Ar) generates K.
Chef has no idea how to solve this problem ― can you help him find the answers to all queries?
Input

The first line of the input contains a single integer N.
The second line contains N space-separated integers A1,A2,…,AN.
The third line contains a single integer Q.
The following Q lines describe queries. Each of these lines contains a single integer K.

Output
For each query, print a single line containing one integer ― the number of contiguous subsequences that generate K.
Constraints

1≤N,Q≤105
1≤Ai≤109 for each valid i
1≤K≤106

Subtasks
Subtask #1 (10 points): 1≤N≤1,000
Subtask #2 (90 points): original constraints

                        Sample Input 1
                        





2
2 4
3
1
2
8



                        Sample Output 1
                        





0
2
3


Explanation
The sequence (2,4) has three contiguous subsequences: (2), (4) and (2,4). 

In the first query, 1 cannot be generated by any subsequence.
In the second query, 2 is generated by subsequences (2) and (2,4). For example, for the subsequence (2,4), we can choose C1=1 and C2=0.
In the third query, 8 is generated by all three subsequences.




Author:
4★hackslash_123


Editorial:
https://discuss.codechef.com/problems/FUZZYLIN


Tags:

               
                 Pre processing, GCD, Bezout's Identity, Sieve of Eratosthenes, Observation
                 
                     
                     Advanced Algorithms, Mathematics, Number Theory, Algorithms
                 
               
             
             



                        Difficulty Rating:
                    

2301


Date Added:
15-07-2019


Time Limit:
1 secs


Source Limit:
50000 Bytes


Languages:
PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM





Submit

